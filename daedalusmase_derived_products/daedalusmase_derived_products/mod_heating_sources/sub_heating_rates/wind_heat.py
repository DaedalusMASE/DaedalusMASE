"""
sub_Heating_Sources.wind_heat

**Description**:
_____________________________________________________________________________________________________________________

Calculate wind heating rate in W/m^3
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

sigmaPed:

bnorm:

tm2:

tm1:

tm3:

Un_x:

Un_y:

Un_z:

Ui_x:

Ui_y:

Ui_z
_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

Wind_heating: wind heating rate in W/m^3

_________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:
_____________________________________________________________________________________________________________________

______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np

def wind_heat(sigmaPed,E_enu,B_enu,Un):

    UnxB_wind=np.cross(Un,B_enu)
    unxb_mag_wind=np.sqrt(UnxB_wind[0]*UnxB_wind[0]+UnxB_wind[1]*UnxB_wind[1]+UnxB_wind[2]*UnxB_wind[2])
    exb_wind=np.cross(E_enu,B_enu)
    dot_wind=np.dot(Un,exb_wind)
    
    Wind_heating=sigmaPed*unxb_mag_wind*unxb_mag_wind-2*sigmaPed*dot_wind
                    
    return Wind_heating