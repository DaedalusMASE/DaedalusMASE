"""
sub_Heating_Sources.wind_heat

**Description**:
_____________________________________________________________________________________________________________________

Calculate wind heating rate in \(W/m^{3}\)

$$q_w=\\sigma_P |\\vec{u}_n \\times \\vec{B}|^2-2\\sigma_P \\vec{u}_n \\cdot \\Big(\\vec{E}\\times \\vec{B} \\Big)$$
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

`sigmaPed`: Pedersen conductivity in \(S/m\)

`E_enu`: electric feild in \(V/m\) [ENU]

`B_enu`: magnetic feild in \(T\) [ENU]

`Un`: neutral velocity in \(m/s\) [ENU]

_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

Wind_heating: wind heating rate in \(W/m^{3}\)

_________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:
_____________________________________________________________________________________________________________________

Lu, G., Richmond, A., Emery, B., and Roble, R. (1995). Magnetosphere-ionosphere-thermosphere coupling: Effect of neutral winds on energy transfer and field-aligned current. Journal of Geophysical
Research: Space Physics 100, 19643â€“19659
______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np

def wind_heat(sigmaPed,E_enu,B_enu,Un):

    UnxB_wind=np.cross(Un,B_enu)
    unxb_mag_wind=np.sqrt(UnxB_wind[0]*UnxB_wind[0]+UnxB_wind[1]*UnxB_wind[1]+UnxB_wind[2]*UnxB_wind[2])
    exb_wind=np.cross(E_enu,B_enu)
    dot_wind=np.dot(Un,exb_wind)
    
    Wind_heating=sigmaPed*unxb_mag_wind*unxb_mag_wind-2*sigmaPed*dot_wind
                    
    return Wind_heating