"""
sub_Heating_Sources.ohmic

**Description**:
_____________________________________________________________________________________________________________________

Calculate ohmic heating rate in W/m^3
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

sigmaPed:

E_T_vert:

Unvert:

B:
_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

Ohmic2: 
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**: ohmic heating rate in W/m^3
_____________________________________________________________________________________________________________________

______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np

def ohmic(sigmaPed,E_nu,Un,B_enu):

    bnorm=np.sqrt(B_enu[0]*B_enu[0]+B_enu[1]*B_enu[1]+B_enu[2]*B_enu[2])
    bunit=[B_enu[0]/bnorm,B_enu[1]/bnorm,B_enu[2]/bnorm]
    Unvert=np.cross(Un,bunit)
    A=E_nu+np.cross(Unvert,B_enu)
    Ohmic2=sigmaPed*np.dot(A,A)
    
    return Ohmic2