"""
sub_Heating_Sources.ohmic

**Description**:

$$q_\\Omega= \\sigma_P \\Big(\\vec{E}+\\vec{u}_n \\times \\vec{B} \\Big)^2$$
_____________________________________________________________________________________________________________________

Calculate ohmic heating rate in \(W/m^{3}\)
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

`sigmaPed`: Pedersen conductivity in \(S/m\)

`E_enu`: electric field in \(V/m\) [ENU]

`Un`: neutral velocity in \(m/s\) [ENU]

`B_enu`: electric field in \(V/m\) [ENU]
_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

`Ohmic2`: ohmic heating rate in \(W/m^{3}\)
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**: 
_____________________________________________________________________________________________________________________

Lu, G., Richmond, A., Emery, B., and Roble, R. (1995). Magnetosphere-ionosphere-thermosphere coupling: Effect of neutral winds on energy transfer and field-aligned current. Journal of Geophysical
Research: Space Physics 100, 19643â€“19659
______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np

def ohmic(sigmaPed,E_nu,Un,B_enu):

    bnorm=np.sqrt(B_enu[0]*B_enu[0]+B_enu[1]*B_enu[1]+B_enu[2]*B_enu[2])
    bunit=[B_enu[0]/bnorm,B_enu[1]/bnorm,B_enu[2]/bnorm]
    Unvert=np.cross(Un,bunit)
    A=E_nu+np.cross(Unvert,B_enu)
    Ohmic2=sigmaPed*np.dot(A,A)
    
    return Ohmic2