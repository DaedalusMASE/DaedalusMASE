"""
sub_Heating_Sources.mag_params

**Description**:
_____________________________________________________________________________________________________________________

Calculate magnetic parameters
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

Bz:

By:

Bx:
_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

tm1:

tm2:

tm3:

sndip:
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:
_____________________________________________________________________________________________________________________

______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np

def mag_params(B_enu):
    Bx=B_enu[0]
    By=B_enu[1]
    Bz=B_enu[2]
    dipmag=np.arctan(Bz/np.sqrt(By**2+Bx**2))
    sndip=np.sin(dipmag)
    decmag=np.arctan2(By,Bx)
    sndec=np.sin(decmag)
    sn2dec=sndec**2
    csdec=np.cos(decmag)
    tm1=sn2dec+(1-sn2dec)*sndip**2
    tm2=(1-sn2dec)+sn2dec*sndip**2
    tm3=sndec*csdec*(1-sndip**2)
    
    return tm1,tm2,tm3,sndip