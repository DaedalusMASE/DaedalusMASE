"""
sub_Heating_Sources.wind_heat

**Description**:
_____________________________________________________________________________________________________________________

Calculate wind heating rate in W/m^3
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

sigmaPed:

bnorm:

tm2:

tm1:

tm3:

Un_x:

Un_y:

Un_z:

Ui_x:

Ui_y:

Ui_z
_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

Wind_heating: wind heating rate in W/m^3

_________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:
_____________________________________________________________________________________________________________________

______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np

def wind_heat_tiegcm(sigmaPed,B_enu,tm2,tm1,tm3,Un,Ui):
    bnorm=np.sqrt(B_enu[0]*B_enu[0]+B_enu[1]*B_enu[1]+B_enu[2]*B_enu[2])
    Un_x=Un[0]
    Un_y=Un[1]
    Ui_x=Ui[0]
    Ui_y=Ui[1]

    Wind_heating=sigmaPed*bnorm**2*(tm2*Un_x**2+tm1*Un_y**2-2*tm3*Un_x*Un_y-2*(Un_x*Ui_x+Un_y*Ui_y))  #W/m^3
    
    return Wind_heating