"""
sub_Heating_Sources.convection_heat_tiegcm

**Description**:
_____________________________________________________________________________________________________________________

Calculate convection heating rate in W/m^3 according to TIEGCM
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

sigmaPed: Pedersen conductivity in S/m

bnorm: magnetic field strength in T

tm2: magnetic parameter tm2

tm1: magnetic parameter tm1

tm3: magnetic parameter tm3

Ui_x: x cmoponent of ion ExB drift

Ui_y: y cmoponent of ion ExB drift

sndip: sin of magnetic dip angle
_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

Convenction_heating: convection heating rate in W/m^3
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**: 
_____________________________________________________________________________________________________________________

______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np

def convection_heat_tiegcm(sigmaPed,B_enu,tm2,tm1,tm3,Ui,sndip):      
    bnorm=np.sqrt(B_enu[0]*B_enu[0]+B_enu[1]*B_enu[1]+B_enu[2]*B_enu[2])      
    Ui_x=Ui[0]
    Ui_y=Ui[1]
    Convenct=sigmaPed*(tm1*Ui_x*Ui_x+tm2*Ui_y*Ui_y+2*tm3*Ui_x*Ui_y) #W/m^3
    Convenction_heating=Convenct*bnorm**2/(sndip*sndip)
    
    return Convenction_heating