"""
**sub_Heating_Sources.conductivities**

**Description**:
_____________________________________________________________________________________________________________________

Calculate O+ by solving the coresponding momentum equation
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

`Necm`: electron density in \(cm^{-3}\)

`NO2`: \(O_2\) density in \(cm^{-3}\)

`Te`: electron temperature in K

`Tn`: neutral temperature in K
_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

`Le_O2_vibf_schunk`: Accorsing to Schunk and Nagy [2009] 

`Le_O2_vibf_rees`: According to Rees [1989]

`Le_O2_vibf_tiegcm`: According to TIEGCM formulas
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:
_____________________________________________________________________________________________________________________

Schunk, R. and Nagy, A. (2009). Ionospheres: physics, plasma physics, and chemistry (Cambridge
university press)

Rees, M. H. (1989). Physics and chemistry of the upper atmosphere. Cambridge University Press.
______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""
import numpy as np

def O2_vib(Necm,NO2,Tn,Te):
    #Schunk
    logQ_Te=-19.9171+0.0267*Te-3.9960*(10**(-5))*(Te**2) \
            +3.5187*(10**(-8))*(Te**3)-1.9228*(10**(-11))*(Te**4) \
            +6.6865*(10**(-15))*(Te**5)-1.4791*(10**(-18))*(Te**6) \
            +2.0127*(10**(-22))*(Te**7)-1.5346*(10**(-26))*(Te**8) \
            +5.0148*(10**(-31))*(Te**9)

    Q_Te=10**(logQ_Te)


    Le_O2_vibf_schunk=(Necm*NO2*Q_Te*(1-np.exp(2239*(Te**(-1)-Tn**(-1)))))*1.60217662*10**(-13)  #W/m^3
    
    #Rees and Roble
    if Te<=350:
        B_L=0
    elif Te>350 and Te<=500:
        B_L=1.3*10**(-4)*np.exp(2.532*10**(-2)*(Te-350))
    elif Te>500 and Te<=1000:
        B_L=1.933*10**(-3)*(1+9.11*10**(-2)*(Te-500)+2*np.exp(7.6813*10**(-3)*(Te-500)))
    elif Te>1000 and Te<=1400:
        B_L=0.135*(1+5.185*10**(-3)*(Te-1000)+np.exp(2.8042*10**(-3)*(Te-1000)))
    elif Te>1400 and Te<=2000:
        B_L=0.83+1.95*10**(-3)*(Te-1400)
    elif Te>2000 and Te<=3000:
        B_L=2+2.75*10**(-3)*(Te-2000)
    elif Te>3000 and Te<=5000:
        B_L=4.75+2.925*10**(-3)*(Te-3000)
    elif Te>5000:
        B_L=10.6*np.exp(1.5875*10**(-4)*(Te-5000))


    Le_O2_vibf_rees=10**(-11)*Necm*NO2*B_L*1.60217662*10**(-13)  #W/m^3
    
    #TIEGCM
    
    Le_O2_vibf_tiegcm=Necm*NO2*3.125*10**(-21)*Te*Te*1.60217662*10**(-13)  
    
    return Le_O2_vibf_schunk,Le_O2_vibf_rees,Le_O2_vibf_tiegcm
