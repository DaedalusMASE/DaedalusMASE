"""
sub_Heating_Sources.op_n_frictional

**Description**:
_____________________________________________________________________________________________________________________

Calculate O+-neutral frictional heating rate in W/m^3
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

NO2p:

vo2p_o:

vo2p_o2:

vo2p_n2:

vo2p_he:

vi_o2p_starmag:
_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

qFo2p_o:

qFo2p_o2:

qFo2p_n2:

qFo2p_he:

qFo2p_n:
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:
_____________________________________________________________________________________________________________________

______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np
from daedalusmase_derived_products.mod_tiegcm_utils import const

def o2p_n_frictional(NO2p,vo2p_o,vo2p_o2,vo2p_n2,vo2p_he,vi_o2p_starmag):

    MO=const.mO/(const.NA*1000)  # Atomic oxygen mass in kg
    MO2=(2*const.mO)/(const.NA*1000) # Molecular oxygen mass in kg
    MNO=(const.mNO)/(const.NA*1000) #Nitric oxide mass in kg                    
    MN2=28/(const.NA*1000)   #Nitrogen mass in kg
    MHe=4/(const.NA*1000)
    MN=14/(const.NA*1000)
    MHE=4/(const.NA*1000)

    qFo2p_o=NO2p*MO2*(MO/(MO2+MO))*vo2p_o*vi_o2p_starmag*vi_o2p_starmag
    qFo2p_o2=NO2p*MO2*(MO2/(MO2+MO2))*vo2p_o2*vi_o2p_starmag*vi_o2p_starmag
    qFo2p_n2=NO2p*MO2*(MN2/(MO2+MN2))*vo2p_n2*vi_o2p_starmag*vi_o2p_starmag
    qFo2p_he=NO2p*MO2*(MHE/(MO2+MHE))*vo2p_he*vi_o2p_starmag*vi_o2p_starmag
    

    qFo2p_n=qFo2p_o+qFo2p_o2+qFo2p_n2+qFo2p_he

    return qFo2p_o,qFo2p_o2,qFo2p_n2,qFo2p_he,qFo2p_n