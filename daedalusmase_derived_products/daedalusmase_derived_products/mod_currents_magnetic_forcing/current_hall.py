"""
sub_Heating_Sources.current_hall

**Description**:
_____________________________________________________________________________________________________________________

Calculate Hall current density

$$j_{Hall}=\\sigma_H \\hat{b} \\times \\vec{E}^*$$
_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

`sigmaHall`: Hall conductivity in S/m

`Un`: neutral velocity in m/s [ENU]

`B`: magnetic field vector in T [ENU]

`E`: electric field vector in V/m [ENU]


_____________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

`J_hall`: Hall current density vector in \(A/m^2\)

`J_he`: Hall current density in \(A/m^2\) [east]

`J_hn`: Hall current density in \(A/m^2\) [north]

`J_hu`: Hall current density in \(A/m^2\) [up]
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:
_____________________________________________________________________________________________________________________

Richmond, A. and Thayer, J. (2000). Ionospheric electrodynamics: A tutorial. Magnetospheric current
systems 118, 131â€“146
______________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""


import numpy as np

def current_hall(sigmaHall,Un,B,E):

    bnorm = np.sqrt(B[0] * B[0] + B[1] * B[1] + B[2] * B[2])
    b_unit = [B[0] / bnorm, B[1]/ bnorm, B[2] / bnorm]

    Unvert=np.cross(Un,b_unit)

    Estar=E+np.cross(Unvert,B)

    J_hall=sigmaHall*np.cross(b_unit,Estar)
    J_he=J_hall[0]
    J_hn=J_hall[1]
    J_hu=J_hall[2]

    return J_hall,J_he,J_hn,J_hu
