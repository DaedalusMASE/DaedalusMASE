<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>ATBDs.factors API documentation</title>
<meta name="description" content="This file containes all the required factors, constants and global variables
which are required to execute product derivation and error propagation to â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ATBDs.factors</code></h1>
</header>
<section id="section-intro">
<p>This file containes all the required factors, constants and global variables
which are required to execute product derivation and error propagation to estimate the
overall error and error contribution on the calculation of Heating rates, Conductivites and other parameters</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#39;&#39;&#39;
This file containes all the required factors, constants and global variables
which are required to execute product derivation and error propagation to estimate the
overall error and error contribution on the calculation of Heating rates, Conductivites and other parameters
&#39;&#39;&#39;

import numpy as np

# ######################## CONSTANTS ########################
qe = 1.602176565 * 10 ** (-19)  # electron charge in coulomb
me = 9.10938356 * 10 ** (-31)   # electron mass in kg
mO = 15.9994   # Oxygen atomic mass in g/mol
mO2 = 2 * mO   # Oxygen molecular mass in g/mol
mN = 14.0067   # Nitrogen atomic mass in g/mol
mN2 = 2 * mN   # Nitrogen molecular mass in g/mol
mNO = mN + mO  # Nitric oxide mass in g/mol

boltzmann = 1.380645852 * 10 ** (-16)  # Boltzmann&#39;s constant in cm^2 * g * s^(-2) * K^(-1)
nAvogadro = 6.02214086 * 10 ** 23      # Avogadro&#39;s constant in mol^(-1)
fb = 1.5  # Burnside Factor, the factor that connects theoretical and practical estimations of O+

# Masses in kg
mkO = mO / (nAvogadro * 1000)
mkO2 = mO2 / (nAvogadro * 1000)
mkN = mN / (nAvogadro * 1000)
mkN2 = mN2 / (nAvogadro * 1000)
mkNO = mNO / (nAvogadro * 1000)

ccm = 10 ** 6  # constant to convert cm^(-3) to m^(-3)


glat_in=0  # lat values variable to store TIE-GCMs latitude
glon_in=0  # lon values variable to store TIE-GCMs longitude
glev_in=0 # pressure level variable (lev not ilev) to store TIE-GCMs lev
title=&#34;&#34;    # variable to store titles for plots
map_time=&#34;&#34; # variable to store time used for night shadow in lat-lon map plots
pngNameMap=&#34;&#34;

# Altitudes
heights = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Altitude used in Lat - Alt plot
heights_la = np.zeros(57, order=&#39;F&#39;)

# Magnetic field
Bx = np.zeros((72, 144, 57), order=&#39;F&#39;)
By = np.zeros((72, 144, 57), order=&#39;F&#39;)
Bz = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Electric field
Ex = np.zeros((72, 144, 57), order=&#39;F&#39;)
Ey = np.zeros((72, 144, 57), order=&#39;F&#39;)
Ez = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Neutral wind
Unx = np.zeros((72, 144, 57), order=&#39;F&#39;)
Uny = np.zeros((72, 144, 57), order=&#39;F&#39;)
Unz = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Densities
NO = np.zeros((72, 144, 57), order=&#39;F&#39;)
NO2 = np.zeros((72, 144, 57), order=&#39;F&#39;)
NN2 = np.zeros((72, 144, 57), order=&#39;F&#39;)
NOp = np.zeros((72, 144, 57), order=&#39;F&#39;)
NO2p = np.zeros((72, 144, 57), order=&#39;F&#39;)
NNOp = np.zeros((72, 144, 57), order=&#39;F&#39;)
Ne = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Temperatures
Te = np.zeros((72, 144, 57), order=&#39;F&#39;)
Ti = np.zeros((72, 144, 57), order=&#39;F&#39;)
Tn = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Collision frequencies
nu_Op_sum = np.zeros((72, 144, 57), order=&#39;F&#39;)
nu_O2p_sum = np.zeros((72, 144, 57), order=&#39;F&#39;)
nu_NOp_sum = np.zeros((72, 144, 57), order=&#39;F&#39;)
nu_e_sum = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Conductivities
pedersen_con = np.zeros((72, 144, 57), order=&#39;F&#39;)
hall_con = np.zeros((72, 144, 57), order=&#39;F&#39;)
parallel_con = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Ion velocities perpendicular to magnetic field
Vi_vertx = np.zeros((72, 144, 57), order=&#39;F&#39;)
Vi_verty = np.zeros((72, 144, 57), order=&#39;F&#39;)
Vi_vertz = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Heating rates
Joule_Heating = np.zeros((72, 144, 57), order=&#39;F&#39;)
Frictional_Heating = np.zeros((72, 144, 57), order=&#39;F&#39;)
Ohmic_Heating = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Cross sections
C_Op = np.zeros((72, 144, 57), order=&#39;F&#39;)
C_O2p = np.zeros((72, 144, 57), order=&#39;F&#39;)
C_NOp = np.zeros((72, 144, 57), order=&#39;F&#39;)
C_ion = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Perpendicular currents
J_pedersen = np.zeros((72, 144, 57), order=&#39;F&#39;)
J_hall = np.zeros((72, 144, 57), order=&#39;F&#39;)
J_ohmic = np.zeros((72, 144, 57), order=&#39;F&#39;)
J_dens = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Gyro-frequencies
Omega_ion = np.zeros((72, 144, 57), order=&#39;F&#39;)
Omega_e = np.zeros((72, 144, 57), order=&#39;F&#39;)


# Collision frequencies error
nuOp_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
nuO2p_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
nuNOp_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
nue_error = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Conductivities error (absolute)
pedersen_con_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
hall_con_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
parallel_con_error = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Heating rates error (absolute)
Joule_Heating_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
Frictional_Heating_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
Ohmic_Heating_error = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Cross sections error (absolute)
C_Op_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
C_O2p_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
C_NOp_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
C_ion_error = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Perpendicular currents error (absolute)
J_pedersen_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
J_hall_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
J_ohmic_error = np.zeros((72, 144, 57), order=&#39;F&#39;)
J_dens_error = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Collision frequencies contributions error
dnuion_Ti = np.zeros((72, 144, 57), order=&#39;F&#39;)
dnuion_Tn = np.zeros((72, 144, 57), order=&#39;F&#39;)
dnuion_Nneutral = np.zeros((72, 144, 57), order=&#39;F&#39;)
dnue_Te = np.zeros((72, 144, 57), order=&#39;F&#39;)
dnue_Nneutral = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Pedersen conductivity contributions error
dsp_B = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsp_Te = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsp_Ti = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsp_Tn = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsp_Nion = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsp_Ne = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsp_Nneutral = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Hall conductivity contributions error
dsh_B = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsh_Te = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsh_Ti = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsh_Tn = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsh_Nion = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsh_Ne = np.zeros((72, 144, 57), order=&#39;F&#39;)
dsh_Nneutral = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Joule Heating contributions error
dJH_B = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJH_E = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJH_Vi = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJH_Un = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJH_Ne = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Ohmic Heating contributions error
dOH_B = np.zeros((72, 144, 57), order=&#39;F&#39;)
dOH_E = np.zeros((72, 144, 57), order=&#39;F&#39;)
dOH_Nneutral = np.zeros((72, 144, 57), order=&#39;F&#39;)
dOH_Nion = np.zeros((72, 144, 57), order=&#39;F&#39;)
dOH_Un = np.zeros((72, 144, 57), order=&#39;F&#39;)
dOH_Ne = np.zeros((72, 144, 57), order=&#39;F&#39;)
dOH_Te = np.zeros((72, 144, 57), order=&#39;F&#39;)
dOH_Tn = np.zeros((72, 144, 57), order=&#39;F&#39;)
dOH_Ti = np.zeros((72, 144, 57), order=&#39;F&#39;)
dOH_sp = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Frictional Heating contributions error
dFH_B = np.zeros((72, 144, 57), order=&#39;F&#39;)
dFH_Nneutral = np.zeros((72, 144, 57), order=&#39;F&#39;)
dFH_Nion = np.zeros((72, 144, 57), order=&#39;F&#39;)
dFH_Un = np.zeros((72, 144, 57), order=&#39;F&#39;)
dFH_Tn = np.zeros((72, 144, 57), order=&#39;F&#39;)
dFH_Ti = np.zeros((72, 144, 57), order=&#39;F&#39;)
dFH_Vi = np.zeros((72, 144, 57), order=&#39;F&#39;)
dFH_nu = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Ion cross section contribution error
dCion_Ti = np.zeros((72, 144, 57), order=&#39;F&#39;)
dCion_Tn = np.zeros((72, 144, 57), order=&#39;F&#39;)
dCion_nu = np.zeros((72, 144, 57), order=&#39;F&#39;)
dCion_Nneutral = np.zeros((72, 144, 57), order=&#39;F&#39;)

# Perpendicular currents contributions error
dJohm_B = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_E = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_Un = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_sp = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_sh = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_Ti = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_Tn = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_Te = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_Ne = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_Nneutral = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJohm_Nion = np.zeros((72, 144, 57), order=&#39;F&#39;)

dJd_B = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJd_E = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJd_Vi = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJd_Un = np.zeros((72, 144, 57), order=&#39;F&#39;)
dJd_Ne = np.zeros((72, 144, 57), order=&#39;F&#39;)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="ATBDs" href="index.html">ATBDs</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>